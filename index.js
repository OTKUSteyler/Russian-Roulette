(function(u,c,E,a,p,b,e,T){"use strict";const{FormRow:l,FormSwitch:f,FormSection:g,FormDivider:y,FormInput:k,FormText:S}=T.Forms,h=function(t,o){c.storage.settings[t]=o,window.__vendetta_common?.FluxDispatcher&&window.__vendetta_common.FluxDispatcher.dispatch({type:"VENDETTA_SETTINGS_UPDATE"})};function w(){const[,t]=e.React.useReducer(function(n){return n+1},0),o=function(n,s){return c.storage.settings[n]??s};return e.React.createElement(e.React.Fragment,null,e.React.createElement(g,{title:"Basic Settings"},e.React.createElement(l,{label:"Exclude this plugin",subLabel:"Prevent this plugin from being removed by its own roulette",leading:e.React.createElement(l.Icon,{source:{uri:"https://cdn.discordapp.com/emojis/1098182204997910610.webp"}}),trailing:e.React.createElement(f,{value:o("excludeSelf",!0),onValueChange:function(n){h("excludeSelf",n),t()}})}),e.React.createElement(l,{label:"Allow reroll",subLabel:"Enable this to allow multiple attempts (no punishment)",leading:e.React.createElement(l.Icon,{source:{uri:"https://cdn.discordapp.com/emojis/1097457501932408933.webp"}}),trailing:e.React.createElement(f,{value:o("allowReroll",!1),onValueChange:function(n){h("allowReroll",n),t()}})})),e.React.createElement(y,null),e.React.createElement(g,{title:"Advanced Settings"},e.React.createElement(l,{label:"Skip confirmation",subLabel:"Remove plugins without asking for confirmation (dangerous!)",leading:e.React.createElement(l.Icon,{source:{uri:"https://cdn.discordapp.com/emojis/1097457529678319706.webp"}}),trailing:e.React.createElement(f,{value:o("skipConfirmation",!1),onValueChange:function(n){h("skipConfirmation",n),t()}})})),e.React.createElement(g,{title:"Information"},e.React.createElement(S,null,"Russian Roulette plugin will randomly remove one of your installed plugins when you lose. Be careful - this can remove important plugins!")))}c.storage.settings??={allowReroll:!1,excludeSelf:!0};const _=function(){const t=p.getPlugins(),o=Object.keys(t),n=window.__vendetta_loader__.plugins.find(function(r){return r.manifest&&r.manifest.name==="Russian-Roulette"})?.id,s=c.storage.settings.excludeSelf&&n?o.filter(function(r){return r!==n}):o;if(s.length===0){a.showToast("Not enough plugins to play!",i("error"));return}const m=Math.floor(Math.random()*6)+1;if(m!==6){a.showToast(`You rolled a ${m}. You're safe!`,i("success"));return}const C=Math.floor(Math.random()*s.length),R=s[C],v=t[R]?.manifest?.name||R;b.showConfirmationAlert({title:"Russian Roulette",content:`You rolled a ${m}. The plugin "${v}" will be removed!`,confirmText:"Proceed",cancelText:"Cancel",onConfirm:function(){try{p.removePlugin(R),a.showToast(`Plugin "${v}" removed!`,i("danger"))}catch(r){a.showToast(`Failed to remove plugin: ${r?.message||"Unknown error"}`,i("error"))}}})};function i(t){return typeof a.showToast=="function"&&a.showToast.length>=2?{type:t}:{content:t}}let d;try{d=E.addSettings("Russian Roulette",w)}catch(t){console.error("Failed to add settings:",t)}function F(){a.showToast("Russian Roulette Plugin Loaded!",i("info"))}function P(){d&&typeof d.remove=="function"&&d.remove(),a.showToast("Russian Roulette Plugin Unloaded!",i("info"))}return u.Settings=w,u.onLoad=F,u.onUnload=P,u.playRussianRoulette=_,u})({},vendetta.plugin,vendetta.ui.settings,vendetta.ui.toasts,vendetta.plugins,vendetta.ui.alerts,vendetta.common,vendetta.ui.components);
